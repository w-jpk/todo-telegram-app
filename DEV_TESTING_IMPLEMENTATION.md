# Реализация тестирования в Dev режиме

## Что было реализовано

### 1. Dev утилиты для браузерной консоли

**Файл**: `tests/dev-helpers.ts`

Добавлены утилиты, доступные через `window.__DEV_TEST_UTILS__`:
- `createTestTodo()` - создание тестовых задач
- `createTestProject()` - создание тестовых проектов
- `logTodos()` - логирование состояния задач в удобном формате
- `mockApiResponse()` - мокирование API ответов
- `clearStorage()` - очистка localStorage и sessionStorage
- `setTestUser()` - установка тестового пользователя Telegram

### 2. Плагин для автоматической загрузки утилит

**Файл**: `plugins/dev-test-utils.client.ts`

Плагин автоматически загружает dev утилиты при запуске в dev режиме.
Доступен только на клиенте и только в dev окружении.

### 3. Специальные команды для dev тестирования

**Файл**: `package.json`

Добавлены команды:
- `test:dev` - тесты в watch режиме с NODE_ENV=development
- `test:dev:ui` - тесты с UI интерфейсом в dev режиме
- `test:dev:coverage` - тесты с покрытием в dev режиме
- `test:e2e:dev` - E2E тесты в dev режиме

### 4. Документация

**Созданные файлы**:
- `DEV_TESTING.md` - полное руководство по тестированию в dev
- `README_DEV_TESTING.md` - краткая инструкция
- Обновлен `TESTING.md` с информацией о dev тестировании

### 5. Существующая инфраструктура

**Уже было в проекте**:
- Страница `/dev/components` для ручного тестирования компонентов
- Middleware `dev-only` для защиты dev страниц
- Конфигурация Vitest с поддержкой Nuxt
- Тестовые утилиты в `tests/utils/test-helpers.ts`

## Как использовать

### Вариант 1: Watch режим (рекомендуется)

```bash
# Терминал 1
npm run dev

# Терминал 2
npm run test:watch
```

### Вариант 2: UI интерфейс

```bash
npm run test:dev:ui
```

Откроется интерактивный интерфейс для запуска и отладки тестов.

### Вариант 3: Тестирование в браузере

1. Запустите `npm run dev`
2. Откройте `http://localhost:3002/dev/components`
3. Используйте интерактивную страницу для тестирования
4. Используйте консоль браузера с `__DEV_TEST_UTILS__`

## Преимущества реализации

1. **Автоматическая загрузка** - утилиты загружаются автоматически в dev режиме
2. **Удобство использования** - простой доступ через консоль браузера
3. **Гибкость** - можно тестировать как через тесты, так и в браузере
4. **Безопасность** - все работает только в dev режиме
5. **Документация** - подробные инструкции по использованию

## Структура файлов

```
tests/
├── dev-helpers.ts          # Утилиты для браузерной консоли
├── dev-test-runner.ts      # Утилиты для программного запуска
├── setup.ts                # Глобальная настройка тестов
└── utils/
    └── test-helpers.ts     # Общие утилиты

plugins/
└── dev-test-utils.client.ts  # Плагин для загрузки утилит

pages/
└── dev/
    └── components.vue     # Страница для тестирования компонентов

docs/
├── DEV_TESTING.md          # Полное руководство
├── README_DEV_TESTING.md    # Краткая инструкция
└── TESTING.md              # Общее руководство (обновлено)
```

## Примеры использования

### В консоли браузера

```javascript
// Создать тестовую задачу
const todo = __DEV_TEST_UTILS__.createTestTodo({
  text: 'Моя задача',
  priority: 'high',
  dueDate: new Date('2024-12-31')
})

// Логировать состояние
const { todos } = useTodos()
__DEV_TEST_UTILS__.logTodos(todos.value)

// Очистить хранилище
__DEV_TEST_UTILS__.clearStorage()
```

### В тестах

```typescript
import { createMockTodo } from '../utils/test-helpers'

const todo = createMockTodo({ text: 'Test' })
```

## Следующие шаги

1. Использовать утилиты при разработке новых функций
2. Расширять набор утилит по мере необходимости
3. Добавлять новые тесты для покрытия функциональности
4. Использовать страницу `/dev/components` для быстрой проверки UI

## Заключение

Реализована полноценная система тестирования для dev режима, которая позволяет:
- Быстро тестировать компоненты в браузере
- Использовать удобные утилиты в консоли
- Запускать тесты в watch режиме
- Получать мгновенную обратную связь при разработке

Все инструменты работают только в dev режиме и не влияют на production сборку.

